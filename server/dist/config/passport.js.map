{"version":3,"sources":["../../config/passport.js"],"names":["config","options","secretOrKey","jwtSecret","jwtFromRequest","ExtractJwt","fromAuthHeaderWithScheme","jwtVerify","payload","done","User","findById","sub","err","user","passport","strategies","jwt","JwtStrategy"],"mappings":";;;;;;kBAIe,UAAUA,MAAV,EAAkB;AAC7B,QAAMC,UAAU;AACZC,qBAAaF,OAAOG,SADR;AAEZC,wBAAgBC,wBAAWC,wBAAX,CAAoC,QAApC;AAFJ,KAAhB;;AAKA,QAAMC,YAAY,SAAZA,SAAY,CAACC,OAAD,EAAUC,IAAV,EAAmB;AACjCC,uBAAKC,QAAL,CAAcH,QAAQI,GAAtB,EAA2B,UAACC,GAAD,EAAMC,IAAN,EAAe;AACtC,gBAAID,GAAJ,EAAS;AACL,uBAAOJ,KAAKI,GAAL,EAAU,KAAV,CAAP;AACH;;AAED,gBAAIC,IAAJ,EAAU;AACN,uBAAOL,KAAK,IAAL,EAAWK,IAAX,CAAP;AACH;;AAED,mBAAOL,KAAK,IAAL,EAAW,KAAX,CAAP;AACH,SAVD;AAWH,KAZD;;AAcA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,WAAO;AACHM,oCADG;AAEHC,oBAAY,EAAEC,KAAK,IAAIC,qBAAJ,CAAgBjB,OAAhB,EAAyBM,SAAzB,CAAP;AAFT,KAAP;AAIH,C;;AAtCD;;AACA;;;;AACA","file":"passport.js","sourcesContent":["import { Strategy as JwtStrategy, ExtractJwt } from 'passport-jwt';\nimport User from '../api/users/user.model';\nimport passport from 'passport';\n\nexport default function (config) {\n    const options = {\n        secretOrKey: config.jwtSecret,\n        jwtFromRequest: ExtractJwt.fromAuthHeaderWithScheme('Bearer')\n    }\n\n    const jwtVerify = (payload, done) => {\n        User.findById(payload.sub, (err, user) => {\n            if (err) {\n                return done(err, false);\n            }\n\n            if (user) {\n                return done(null, user);\n            }\n\n            return done(null, false);\n        });\n    }\n\n    // passport.serializeUser((user, done) => {\n    //     done(null, user.id);\n    // });\n\n    // passport.deserializeUser((id, done) => {\n    //     User.findById(id, (err, user) => {\n    //         done(err, user);\n    //     });\n    // });\n\n    return {\n        passport,\n        strategies: { jwt: new JwtStrategy(options, jwtVerify) }\n    };\n}"]}